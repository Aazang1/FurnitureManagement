# 销售管理模块实现计划

## 服务端实现
1. **创建模型类**
   - `SaleOrder` 模型：包含销售订单的基本信息（销售ID、客户姓名、电话、销售日期、总金额、折扣、最终金额、状态等）
   - `SaleDetail` 模型：包含销售明细信息（明细ID、销售ID、家具ID、数量、单价、总价、仓库ID等）

2. **更新数据库上下文**
   - 在 `AppDbContext` 中添加 `SaleOrder` 和 `SaleDetail` 的 DbSet
   - 在 `OnModelCreating` 方法中配置数据库映射关系

3. **实现销售订单控制器**
   - `SaleOrderController`：包含销售订单的增删改查操作
   - 实现销售订单创建功能，自动计算总金额和最终金额
   - 实现销售订单状态更新功能，完成订单时自动更新库存
   - 实现销售明细的管理功能

4. **库存更新逻辑**
   - 销售订单完成时，检查库存是否充足
   - 库存充足则减少对应数量，不足则返回错误
   - 更新库存的最后更新时间

## 客户端实现
1. **创建模型类**
   - `SaleOrder` 模型：对应服务端的销售订单模型
   - `SaleDetail` 模型：对应服务端的销售明细模型

2. **销售订单管理页面**
   - 销售订单列表展示
   - 按日期筛选功能
   - 订单状态管理
   - 新增、编辑、查看订单功能

3. **销售订单编辑窗口**
   - 客户信息填写
   - 销售日期选择
   - 销售明细管理（添加、编辑、删除明细）
   - 自动获取家具单价
   - 自动计算总金额、折扣、最终金额
   - 仓库选择

4. **API服务集成**
   - 在 `ApiService` 中添加销售订单相关的API调用方法

## 实现步骤
1. 服务端模型创建和数据库配置
2. 服务端控制器实现
3. 客户端模型创建
4. 客户端销售订单管理页面实现
5. 客户端销售订单编辑窗口实现
6. API服务集成
7. 测试功能完整性

## 技术要点
- 采用与现有项目一致的技术栈和代码风格
- 实现销售订单与销售明细的一对多关系
- 实现销售订单完成时的库存自动更新
- 确保数据一致性和完整性
- 提供良好的用户体验和错误处理