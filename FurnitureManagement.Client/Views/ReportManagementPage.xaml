<Page x:Class="FurnitureManagement.Client.Views.ReportManagementPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:FurnitureManagement.Client.Views"
      mc:Ignorable="d" 
      d:DesignHeight="450" d:DesignWidth="800"
      Title="统计报表">
    <Grid Background="#F5F5F5">
        <StackPanel Margin="20">
            <!-- 标题 -->
            <TextBlock Text="统计报表" FontSize="24" FontWeight="Bold" Foreground="#333333" Margin="0,0,0,20"/>
            
            <!-- 标签页控件 -->
            <TabControl x:Name="tabControl" Height="600">
                <!-- 库存管理报表标签页 -->
                <TabItem Header="库存管理报表" IsSelected="True">
                    <StackPanel Margin="10">
                        <!-- 刷新按钮 -->
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,0,0,15">
                            <Button Content="刷新数据" Height="35" Background="#3498DB" Foreground="White" 
                                    BorderBrush="Transparent" Click="btnRefreshInventorySummary_Click">
                                <Button.Style>
                                    <Style TargetType="Button">
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="#2980B9"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>
                        </StackPanel>
                        
                        <!-- 库存管理报表数据网格 -->
                        <DataGrid x:Name="dgInventorySummary" AutoGenerateColumns="False" CanUserAddRows="False" 
                                  SelectionMode="Single" SelectionUnit="FullRow" Background="White"
                                  BorderBrush="#E0E0E0" BorderThickness="1" RowHeight="40">
                            <!-- 列样式 -->
                            <DataGrid.ColumnHeaderStyle>
                                <Style TargetType="DataGridColumnHeader">
                                    <Setter Property="Background" Value="#F5F5F5"/>
                                    <Setter Property="Foreground" Value="#333333"/>
                                    <Setter Property="FontWeight" Value="Bold"/>
                                    <Setter Property="BorderBrush" Value="#E0E0E0"/>
                                    <Setter Property="BorderThickness" Value="0,0,0,1"/>
                                    <Setter Property="Padding" Value="10"/>
                                </Style>
                            </DataGrid.ColumnHeaderStyle>
                            
                            <!-- 行样式 -->
                            <DataGrid.RowStyle>
                                <Style TargetType="DataGridRow">
                                    <Style.Triggers>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter Property="Background" Value="#E6F2FF"/>
                                            <Setter Property="Foreground" Value="#3498DB"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGrid.RowStyle>
                            
                            <!-- 单元格样式 -->
                            <DataGrid.CellStyle>
                                <Style TargetType="DataGridCell">
                                    <Setter Property="BorderBrush" Value="#E0E0E0"/>
                                    <Setter Property="BorderThickness" Value="0,0,0,1"/>
                                    <Setter Property="Padding" Value="10"/>
                                </Style>
                            </DataGrid.CellStyle>
                            
                            <!-- 列定义 -->
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="商品ID" Binding="{Binding FurnitureId}" Width="80" IsReadOnly="True"/>
                                <DataGridTextColumn Header="商品名称" Binding="{Binding FurnitureName}" Width="150" IsReadOnly="True"/>
                                <DataGridTextColumn Header="分类" Binding="{Binding CategoryName}" Width="120" IsReadOnly="True"/>
                                <DataGridTextColumn Header="仓库" Binding="{Binding WarehouseName}" Width="120" IsReadOnly="True"/>
                                <DataGridTextColumn Header="库存数量" Binding="{Binding Quantity}" Width="100" IsReadOnly="True"/>
                                <DataGridTextColumn Header="进货单价" Binding="{Binding PurchasePrice, StringFormat='C2'}" Width="100" IsReadOnly="True"/>
                                <DataGridTextColumn Header="销售单价" Binding="{Binding SalePrice, StringFormat='C2'}" Width="100" IsReadOnly="True"/>
                                <DataGridTextColumn Header="库存成本" Binding="{Binding InventoryCost, StringFormat='C2'}" Width="120" IsReadOnly="True"/>
                                <DataGridTextColumn Header="库存价值" Binding="{Binding InventoryValue, StringFormat='C2'}" Width="120" IsReadOnly="True"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </TabItem>
                
                <!-- 销售日报标签页 -->
                <TabItem Header="销售日报">
                    <StackPanel Margin="10">
                        <!-- 刷新按钮 -->
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,0,0,15">
                            <Button Content="刷新数据" Height="35" Background="#3498DB" Foreground="White" 
                                    BorderBrush="Transparent" Click="btnRefreshSalesDaily_Click">
                                <Button.Style>
                                    <Style TargetType="Button">
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="#2980B9"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>
                        </StackPanel>
                        
                        <!-- 销售日报数据网格 -->
                        <DataGrid x:Name="dgSalesDaily" AutoGenerateColumns="False" CanUserAddRows="False" 
                                  SelectionMode="Single" SelectionUnit="FullRow" Background="White"
                                  BorderBrush="#E0E0E0" BorderThickness="1" RowHeight="40">
                            <!-- 列样式 -->
                            <DataGrid.ColumnHeaderStyle>
                                <Style TargetType="DataGridColumnHeader">
                                    <Setter Property="Background" Value="#F5F5F5"/>
                                    <Setter Property="Foreground" Value="#333333"/>
                                    <Setter Property="FontWeight" Value="Bold"/>
                                    <Setter Property="BorderBrush" Value="#E0E0E0"/>
                                    <Setter Property="BorderThickness" Value="0,0,0,1"/>
                                    <Setter Property="Padding" Value="10"/>
                                </Style>
                            </DataGrid.ColumnHeaderStyle>
                            
                            <!-- 行样式 -->
                            <DataGrid.RowStyle>
                                <Style TargetType="DataGridRow">
                                    <Style.Triggers>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter Property="Background" Value="#E6F2FF"/>
                                            <Setter Property="Foreground" Value="#3498DB"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGrid.RowStyle>
                            
                            <!-- 单元格样式 -->
                            <DataGrid.CellStyle>
                                <Style TargetType="DataGridCell">
                                    <Setter Property="BorderBrush" Value="#E0E0E0"/>
                                    <Setter Property="BorderThickness" Value="0,0,0,1"/>
                                    <Setter Property="Padding" Value="10"/>
                                </Style>
                            </DataGrid.CellStyle>
                            
                            <!-- 列定义 -->
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="销售日期" Binding="{Binding SaleDay, StringFormat='yyyy-MM-dd'}" Width="120" IsReadOnly="True"/>
                                <DataGridTextColumn Header="订单数量" Binding="{Binding OrderCount}" Width="100" IsReadOnly="True"/>
                                <DataGridTextColumn Header="销售总额" Binding="{Binding TotalSales, StringFormat='C2'}" Width="120" IsReadOnly="True"/>
                                <DataGridTextColumn Header="总折扣" Binding="{Binding TotalDiscount, StringFormat='C2'}" Width="120" IsReadOnly="True"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </TabItem>
                
                <!-- 人员操作报表标签页 -->
                <TabItem Header="人员操作报表">
                    <StackPanel Margin="10">
                        <!-- 刷新按钮 -->
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,0,0,15">
                            <Button Content="刷新数据" Height="35" Background="#3498DB" Foreground="White" 
                                    BorderBrush="Transparent" Click="btnRefreshUserOperations_Click">
                                <Button.Style>
                                    <Style TargetType="Button">
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="#2980B9"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>
                        </StackPanel>
                        
                        <!-- 人员操作报表数据网格 -->
                        <DataGrid x:Name="dgUserOperations" AutoGenerateColumns="False" CanUserAddRows="False" 
                                  SelectionMode="Single" SelectionUnit="FullRow" Background="White"
                                  BorderBrush="#E0E0E0" BorderThickness="1" RowHeight="40">
                            <!-- 列样式 -->
                            <DataGrid.ColumnHeaderStyle>
                                <Style TargetType="DataGridColumnHeader">
                                    <Setter Property="Background" Value="#F5F5F5"/>
                                    <Setter Property="Foreground" Value="#333333"/>
                                    <Setter Property="FontWeight" Value="Bold"/>
                                    <Setter Property="BorderBrush" Value="#E0E0E0"/>
                                    <Setter Property="BorderThickness" Value="0,0,0,1"/>
                                    <Setter Property="Padding" Value="10"/>
                                </Style>
                            </DataGrid.ColumnHeaderStyle>
                            
                            <!-- 行样式 -->
                            <DataGrid.RowStyle>
                                <Style TargetType="DataGridRow">
                                    <Style.Triggers>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter Property="Background" Value="#E6F2FF"/>
                                            <Setter Property="Foreground" Value="#3498DB"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGrid.RowStyle>
                            
                            <!-- 单元格样式 -->
                            <DataGrid.CellStyle>
                                <Style TargetType="DataGridCell">
                                    <Setter Property="BorderBrush" Value="#E0E0E0"/>
                                    <Setter Property="BorderThickness" Value="0,0,0,1"/>
                                    <Setter Property="Padding" Value="10"/>
                                </Style>
                            </DataGrid.CellStyle>
                            
                            <!-- 列定义 -->
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="用户ID" Binding="{Binding UserId}" Width="80" IsReadOnly="True"/>
                                <DataGridTextColumn Header="用户名" Binding="{Binding Username}" Width="120" IsReadOnly="True"/>
                                <DataGridTextColumn Header="真实姓名" Binding="{Binding RealName}" Width="120" IsReadOnly="True"/>
                                <DataGridTextColumn Header="角色" Binding="{Binding Role}" Width="100" IsReadOnly="True"/>
                                <DataGridTextColumn Header="采购订单数" Binding="{Binding PurchaseOrders}" Width="120" IsReadOnly="True"/>
                                <DataGridTextColumn Header="销售订单数" Binding="{Binding SaleOrders}" Width="120" IsReadOnly="True"/>
                                <DataGridTextColumn Header="最后登录" Binding="{Binding LastLogin, StringFormat='yyyy-MM-dd HH:mm'}" Width="150" IsReadOnly="True"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </TabItem>
            </TabControl>
        </StackPanel>
    </Grid>
</Page>